# 数据库配置 (用于新架构)
database:
  path: "data/stock.db"

# 下载器配置 - 基于业内最佳实践的默认值
downloader:
  # 单线程模式避免同时调用同一API方法
  max_producers: 1  # 单线程处理，配合Rate Limiter控制API调用频率
  
  # 消费者数量: 通常比生产者少，避免数据库写入瓶颈
  max_consumers: 1  # 单消费者避免数据库锁竞争
  
  # 任务队列: 减小队列避免积压
  producer_queue_size: 1000
  
  # 数据队列: 减小数据队列
  data_queue_size: 500
  
  retry_policy:
    max_retries: 3
    base_delay: 1.0
    max_delay: 60.0
    backoff_factor: 2.0
    jitter: true

# 消费者配置
consumer:
  # 批次大小: 100-500条记录平衡性能和内存
  batch_size: 200
  
  # 刷新间隔: 15-60秒，避免数据积压
  flush_interval: 20.0
  
  max_retries: 3

# 获取器配置
fetcher:
  rate_limit: 180  # 保守设置，避免超过200次/分钟限制

# 并发控制
concurrency:
  max_concurrent_tasks: 1

# 任务模板定义：只定义任务的核心类型和参数
tasks:
  update_stock_list:
    name: "更新A股列表"
    type: "stock_list"
    update_interval_hours: 24*7
    
  daily_qfq:
    name: "日K线-前复权"
    type: "daily"
    adjust: "qfq"
    date_col: "trade_date"
    
  daily_none:
    name: "日K线-不复权"
    type: "daily"
    adjust: "none"
    date_col: "trade_date"
    
  daily_basic:
    name: "每日指标"
    type: "daily_basic"
    date_col: "trade_date"
    
  financial_income:
    name: "财务报表-利润表"
    type: "financials"
    statement_type: "income"
    date_col: "ann_date"
    
  financial_balance:
    name: "财务报表-资产负债表"
    type: "financials"
    statement_type: "balancesheet"
    date_col: "ann_date"
    
  financial_cashflow:
    name: "财务报表-现金流量表"
    type: "financials"
    statement_type: "cashflow"
    date_col: "ann_date"

# 组配置：引用任务名称列表
groups:
  default:
    description: "默认组 - 核心股票的完整数据下载"
    symbols: ["600519", "002023", "600276", "600612", 
      "000333", "002415", "000895", "603288", "600900",
      "601100", "603568", "600636", "000651", "600570",
      "000858"]
    tasks: ["update_stock_list", "daily_qfq", "daily_none", "daily_basic", "financial_income", "financial_balance", "financial_cashflow"]
    
  all:
    description: "全股票完整数据下载（包含日K线和财务数据）"
    symbols: "all"
    tasks: ["update_stock_list", "daily_qfq", "daily_none", "daily_basic", "financial_income", "financial_balance", "financial_cashflow"]
    
  daily:
    description: "日K线数据 - 所有股票"
    symbols: "all"
    tasks: ["update_stock_list", "daily_qfq", "daily_none", "daily_basic"]
    
  financial:
    description: "财务报表数据 - 所有股票"
    symbols: "all"
    tasks: ["update_stock_list", "financial_income", "financial_balance", "financial_cashflow"]
    
  quick:
    description: "快速测试组 - 少量股票的财务数据测试"
    symbols: "all"
    tasks: ["financial_income", "financial_balance",]
