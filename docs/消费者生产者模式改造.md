生产者

使用 fetch_data 函数发起请求，通过 ratelimit 装饰器限制每分钟请求次数。
数据成功获取后放入 task_queue，生产者完成后放入 None 作为结束信号。
多个生产者线程并行工作，提升效率。

消费者

从队列中取出数据，积攒到一定数量（BATCH_SIZE）后批量写入 DuckDB。
使用 executemany 提高插入性能。
设置超时机制防止队列空时永久阻塞。

频率控制

ratelimit 确保不超过每分钟请求限制（Tushare 要求不超过 200 次）。
可通过调整 CALLS_PER_MINUTE 和 PERIOD 适配限制。

线程管理

使用 ThreadPoolExecutor 管理消费者线程，设置最大线程数（MAX_WORKERS）。
线程池中的线程会自动处理队列中的数据，无需手动管理。